#!/bin/bash

# Create config directory if it doesn't exist
mkdir -p "$HOME/.config"

# Specify dotfiles directory
DOTFILES_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# --------------- Stow packages ---------------
echo "Stowing dotfiles..."
stow nvim
stow tmux
stow git
stow zsh

# --------------- nvim ---------------

# --------------- tmux ---------------
echo "Setting up tmux..."
# Install TPM
if [ ! -d ~/.config/tmux/plugins/tpm ]; then
  git clone https://github.com/tmux-plugins/tpm ~/.config/tmux/plugins/tpm
    echo "TPM installed"
fi
echo "tmux config complete"

# --------------- zsh ---------------
echo "Setting up zsh..."
# Install oh-my-zsh if not present
if [ ! -d "$HOME/.oh-my-zsh" ]; then
  sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)" "" --unattended
  echo "oh-my-zsh installed"
fi
# Install antigen
mkdir -p "$HOME/.config/zsh/scripts"
if [ ! -f "$HOME/.config/zsh/scripts/antigen.zsh" ]; then
  curl -L git.io/antigen > "$HOME/.config/zsh/scripts/antigen.zsh"
  echo "Antigen installed"
fi
# Install minimal theme (for antigen to find)
if [ ! -d "${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/minimal" ]; then
  git clone https://github.com/subnixr/minimal \
    "${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/minimal"
  echo "Minimal theme installed"
fi

# --------------- git ---------------

echo "Dotfiles installed!"
